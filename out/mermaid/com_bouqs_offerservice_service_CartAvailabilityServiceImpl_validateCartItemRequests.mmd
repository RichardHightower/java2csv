sequenceDiagram
    participant CartAvailabilityServiceImpl
    participant List<CartItemRequest>
    participant List<CartItemResponse>
    participant Map<String, List<String>>
    participant Map<String, List<OfferEntity>>
    participant Map<String, List<OfferEntity>>
    participant Map<String, List<MaterialEntity>>
    participant Map<String, Integer>
    participant log
    
    CartAvailabilityServiceImpl->>log: Start validateCartItemRequests
    CartAvailabilityServiceImpl->>List<CartItemRequest>: Check if cartItemRequests is empty
    List<CartItemRequest]->>CartAvailabilityServiceImpl: Return finalResult if empty
    CartAvailabilityServiceImpl->>List<CartItemRequest>: Get currentCartItemRequest
    CartAvailabilityServiceImpl->>log: Start orderItemNumber: currentCartItemRequest.getOrderItemNumber()
    CartAvailabilityServiceImpl->>CartAvailabilityServiceImpl: Populate default cartItemResponse
    CartAvailabilityServiceImpl->>log: Check if regionIdByZipcodeMap, populatedOfferShortMap, populatedOfferFullMap, populatedMaterialMap, populatedMaterialUsageMap are empty
    CartAvailabilityServiceImpl->>List<CartItemResponse>: Add cartItemResponse to finalResult
    CartAvailabilityServiceImpl->>List<CartItemRequest>: Remove currentCartItemRequest from cartItemRequests
    CartAvailabilityServiceImpl->>CartAvailabilityServiceImpl: Recursive call with updated parameters
    CartAvailabilityServiceImpl->>log: Cannot find any OfferEntity for primaryItem
    CartAvailabilityServiceImpl->>List<CartItemResponse>: Add cartItemResponse to finalResult
    CartAvailabilityServiceImpl->>List<CartItemRequest>: Remove currentCartItemRequest from cartItemRequests
    CartAvailabilityServiceImpl->>CartAvailabilityServiceImpl: Recursive call with updated parameters
    CartAvailabilityServiceImpl->>log: Start validate cartItemRequest with OfferEntity
    CartAvailabilityServiceImpl->>CartAvailabilityServiceImpl: Deep clone populatedOfferFullMap
    CartAvailabilityServiceImpl->>CartAvailabilityServiceImpl: Deep clone populatedOfferShortMap
    CartAvailabilityServiceImpl->>CartAvailabilityServiceImpl: Deep clone populatedMaterialMap
    CartAvailabilityServiceImpl->>CartAvailabilityServiceImpl: Deep clone populatedMaterialUsageMap
    CartAvailabilityServiceImpl->>List<CartItemResponse>: Create result list
    CartAvailabilityServiceImpl->>List<CartItemResponse>: Recursive call with updated parameters
    CartAvailabilityServiceImpl->>log: End validate cartItemRequest with OfferEntity
    CartAvailabilityServiceImpl->>List<CartItemResponse>: Add cartItemResponse to result
    CartAvailabilityServiceImpl->>List<CartItemRequest>: Remove currentCartItemRequest from cartItemRequests
    CartAvailabilityServiceImpl->>CartAvailabilityServiceImpl: Recursive call with updated parameters
    CartAvailabilityServiceImpl->>log: Can find OfferEntities for primaryItem
    CartAvailabilityServiceImpl->>List<CartItemResponse>: Add cartItemResponse to finalResult
    CartAvailabilityServiceImpl->>List<CartItemRequest>: Remove currentCartItemRequest from cartItemRequests
    CartAvailabilityServiceImpl->>CartAvailabilityServiceImpl: Recursive call with updated parameters
    CartAvailabilityServiceImpl->>log: Start populate ItemResponse of orderItemNumber
    CartAvailabilityServiceImpl->>List<CartItemResponse>: Update primary and addons
    CartAvailabilityServiceImpl->>List<CartItemResponse>: Update addOnAvailability
    CartAvailabilityServiceImpl->>List<CartItemResponse>: Update isAllValid
    CartAvailabilityServiceImpl->>List<CartItemResponse>: Update errorMessage
    CartAvailabilityServiceImpl->>List<CartItemResponse>: Add cartItemResponse to finalResult
    CartAvailabilityServiceImpl->>List<CartItemResponse>: Add validatedResult.getRight() to finalResult
    CartAvailabilityServiceImpl->>log: End populate ItemResponse of orderItemNumber
    CartAvailabilityServiceImpl->>List<CartItemResponse>: Return finalResult
